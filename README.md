# Сервис извлечения сущностей для поиска товаров

## Описание

**Хакатон**: Лидеры цифровой трансформации 2025  
**Кейс**: Бизнес #10  
**Заказчик**: x5 group

**Название кейса**: Сервис для выделения сущностей из поискового запроса клиента в мобильном приложении сети "Пятёрочка".

Система использует машинное обучение для извлечения структурированных данных (бренд, тип товара, объем, процент) из неструктурированного текста и интегрируется с поиском товаров.

### Возможности
- 🧠 **Извлечение сущностей**: Автоматическое распознавание брендов, типов товаров, объемов и процентов
- 🔍 **Интеллектуальный поиск**: Фильтрация товаров по извлеченным сущностям
- 🚀 **Микросервисная архитектура**: Масштабируемое решение с разделением ответственности
- 📱 **API для мобильного приложения**: Готовый интерфейс для интеграции

### Примеры работы
```
Запрос: "coca-cola 1.5л"
Извлеченные сущности: BRAND="coca-cola", VOLUME="1.5л"
Результат: Точный поиск товаров Coca-Cola объемом 1.5л

Запрос: "Простоквашино молоко 2.5% 930мл"
Извлеченные сущности: BRAND="Простоквашино", TYPE="молоко", PERCENTAGE="2.5%", VOLUME="930мл"
Результат: Поиск конкретного товара
```

## Быстрый запуск

### Режим хакатона (только ML)
Для демонстрации возможностей машинного обучения:

```bash
cd backend
docker-compose -f docker-compose.hackathon.yml up -d
```

**Тестирование:**
```bash
curl -X POST "http://localhost:8000/api/predict" \
  -H "Content-Type: application/json" \
  -d '{"text": "coca-cola 1.5л"}'
```

### Режим разработки (полная система)
Для демонстрации полного функционала с поиском товаров:

```bash
cd backend
docker-compose -f docker-compose.dev.yml up -d
```

**Заполнение базы данных:**
```bash
docker-compose -f docker-compose.dev.yml exec search_service \
  poetry run python scripts/seed.py
```

**Тестирование:**
```bash
curl -X GET "http://localhost:8000/api/v1/search?q=coca-cola 1.5л"
```

## Технологический стек

### Backend
- **FastAPI** - современный веб-фреймворк для Python
- **SQLModel** - ORM для работы с базой данных
- **PostgreSQL** - реляционная база данных
- **Alembic** - миграции базы данных
- **Poetry** - управление зависимостями

### Machine Learning
- **spaCy** - библиотека для обработки естественного языка
- **PyTorch** - фреймворк машинного обучения
- **uv** - быстрый менеджер пакетов Python
- **BIO-разметка** - стандарт для извлечения именованных сущностей

### Инфраструктура
- **Docker** - контейнеризация
- **Docker Compose** - оркестрация сервисов
- **Микросервисная архитектура** - разделение ответственности

## Архитектура

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Фронтенд      │    │  API Gateway    │    │  NER Service    │
│  (мобильное     │◄──►│   (порт 8000)   │◄──►│   (порт 8001)   │
│   приложение)   │    │                 │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                │
                                ▼
                       ┌─────────────────┐    ┌─────────────────┐
                       │ Search Service  │◄──►│   PostgreSQL    │
                       │   (порт 8002)   │    │   (порт 5433)   │
                       └─────────────────┘    └─────────────────┘
```

## Подробная документация

Для разработчиков и тех, кто хочет глубже изучить систему:

### 📚 [Полная документация](./backend/docs/architecture/README.md)
- Детальное описание архитектуры
- Примеры использования
- Конфигурация и развертывание

### 🔧 [API Gateway](./backend/docs/architecture/api-gateway.md)
- Эндпоинты и параметры
- Логика обработки запросов
- Парсинг BIO-разметки

### 🧠 [NER Service](./backend/docs/architecture/ner-service.md)
- Модель машинного обучения
- Типы сущностей
- Примеры работы

### 🔍 [Search Service](./backend/docs/architecture/search-service.md)
- Модель данных
- Логика поиска и фильтрации
- База данных PostgreSQL

### 📊 [Поток данных](./backend/docs/architecture/data-flow.md)
- Детальная схема взаимодействия
- Преобразования данных
- Обработка ошибок

## Результаты

### Достигнутые метрики

(Раздел в разработке, добавить графики, F1 score, скорость работы, время обработки запроса и тп.)

- **Поддерживаемые типы сущностей**: BRAND, TYPE, VOLUME, PERCENTAGE

## Команда

Проект разработан в рамках хакатона "Лидеры цифровой трансформации 2025" для кейса "Бизнес #10" сети "Пятёрочка".

Команда VibeBaton, всегда к Вашим услугам ;)
